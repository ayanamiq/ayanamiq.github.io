---
title: mysql进阶-索引
tags: mysql
date: 2019-01-07 22:05:33
---

## 索引概述
在关系数据库中，索引是一种单独的、物理的对数据库表中一列或多列的值进行排序的一种存储结构，它是某个表中一列或若干列值的集合和相应的指向表中物理标识这些值的数据页的逻辑指针清单。
简单来说，索引的作用相当于图书的目录，可以根据目录中的页码快速找到所需的内容。

索引提供指向存储在表的指定列中的数据值的指针，然后根据您指定的排序顺序对这些指针排序。数据库使用索引以找到特定值，然后顺指针找到包含该值的行。
这样可以使对应于表的SQL语句执行得更快，可快速访问数据库表中的特定信息。

当表中有大量记录时，若要对表进行查询，第一种搜索信息方式是全表搜索，是将所有记录一一取出，和查询条件进行一一对比，然后返回满足条件的记录，
这样做会消耗大量数据库系统时间，并造成大量磁盘I/O操作；第二种就是在表中建立索引，然后在索引中找到符合查询条件的索引值，最后通过保存在索引中的ROWID（相当于页码）快速找到表中对应的记录。

概念：
索引是为了加速对表中数据行的检索而创建的一种分散的存储结构。索引是针对表而建立的，它是由数据页面以外的索引页面组成的，每个索引页面中的行都会含有逻辑指针，以便加速检索物理数据。

## 作用
优点：
1.加快数据的检索速度
2.唯一索引保证数据唯一
3.加快表连接的速度
4.在使用join、where、group by、having、order by等子句进行数据检索时，利用索引可以减少排序和分组的时间
注：某些where条件会导致索引失效

缺点：
1.索引需要占用物理空间
2.对表中数据进行增删改时，索引也需要维护，加大维护成本

## 使用原则
并不是每个字段度设置索引就好，也不是索引越多越好，合理使用索引
1.对经常查询的字段创建索引，避免对经常更新的字段创建索引
2.数据量小的表尽量不要使用索引，因为由于数据较少，可能查询全部数据花费的时间比遍历索引的时间还要短，索引就可能不会产生优化效果。
3.相同值较多的字段，不要建立索引，如：性别，只有男女两个不同的值。

## 索引分类
索引是在存储引擎中实现的，也就是说不同的存储引擎，会使用不同的索引。
MyISAM和InnoDB存储引擎：只支持BTREE索引，也就是说默认使用BTREE，不能够更换；MEMORY/HEAP存储引擎：支持HASH和BTREE索引。

### B-Tree
B树，不要读作"B减树"。 数据结构中有三种树形结构：B树(B-tree)，B+树(B+tree)，B*树(B*tree)
当人们谈论索引时，如果没有特别指明类型，那多半说的是B-Tree索引，它使用B-Tree数据结构来存储数据。

特点：
1.所有的值都是按顺序存储，并且每一个叶子页到根的距离相同。
2.加快数据的访问速度
3.索引列是顺序组织存储，适合查找范围数据。
4.适用于全键值、键值范围、键前缀(只适用于最左前缀查找)

限制：
1.若不是按照索引的最左列开始查找，则无法使用索引。
2.不能跳过索引中的列。如：有a,b,c三个索引列，若不指定b索引，则无法命中c索引，只能使用a索引。
3.若查询中包含范围查询，则其右边的所有列都无法命中索引(如：like '%J%')

可见索引列的顺序十分重要，在优化性能时，可能需要使用相同的列，但顺序不同的索引来满足不同类型的查询需求。

### (hash index)哈希索引
哈希索引基于哈希表实现，只有精确匹配索引所有列的查询才有效。

111